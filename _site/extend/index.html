<!DOCTYPE html>
<html lang="en">
  
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>shinyjs R package - Extend shinyjs</title>

  <meta name="author" content="Dean Attali" />
  <meta name="description" content="Quickly build a beautiful Jekyll website">

  <link rel="alternate" type="application/rss+xml" title="Beautiful Jekyll - Quickly build a beautiful Jekyll website" href="/shinyjs/feed.xml" />
  
  
    
      <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" />
    
      
  
  
    
      <link rel="stylesheet" href="/shinyjs/css/bootstrap.min.css" />
    
      <link rel="stylesheet" href="/shinyjs/css/bootstrap-social.css" />
    
      <link rel="stylesheet" href="/shinyjs/css/main.css" />
    
    
  
  
    
      <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic" />
    
      <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
    
  

    
  
  

  

  <!-- Facebook OpenGraph tags -->
  
  <meta property="og:title" content="Extend shinyjs" />
  
  
  <meta property="og:type" content="website" />
  
  
  <meta property="og:url" content="http://0.0.0.0:4000/extend/" />
  
  
  
  <meta property="og:image" content="http://0.0.0.0:4000" />
    
  
  <!-- Twitter summary cards -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@daattali" />
  <meta name="twitter:creator" content="@daattali" />
  <meta name="twitter:title" content="Extend shinyjs" />
  <meta name="twitter:description" content="You can also use `shinyjs` to add your own JavaScript functions that can be called from R as if they were regular R functions using `extendShinyjs()`. This is only suitable for advanced users who are familiar with JavaScript and wish to facilitate the communication between R and JavaScript. Simple example..." />
    
</head>


  <body>
  
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/shinyjs/">
	      <span class="col-shiny">shiny</span><span class="col-js">JS</span>
      </a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
      
        
          <li>
            
            





<a href="/shinyjs/index">Home</a>

          </li>
        
        
        
          <li>
            
            





<a href="/shinyjs/overview">Overview</a>

          </li>
        
        
        
          <li>
            
            





<a href="/shinyjs/basic">Quick Start</a>

          </li>
        
        
        
          <li>
            
            





<a href="/shinyjs/example">Example</a>

          </li>
        
        
        
          <li>
            
            





<a href="/shinyjs/extend">Extend shinyjs</a>

          </li>
        
        
        
          <li>
            
            





<a href="/shinyjs/help">Help</a>

          </li>
        
        
      </ul>
    </div>
	
	
	
  </div>
</nav>  


    <div id="page-header">
  <div id="page-title">Extend shinyjs</div>
  <div id="page-subtitle">extendShinyjs: Calling your own JavaScript functions from R</div>
</div>

<div class="container" role="main">
  <div class="row">
    <div class="col-lg-10 col-lg-offset-1 col-md-10 col-md-offset-1">
      <p>You can also use <code class="highlighter-rouge">shinyjs</code> to add your own JavaScript functions that can be called from R as if they were regular R functions using <code class="highlighter-rouge">extendShinyjs()</code>. This is only suitable for advanced users who are familiar with JavaScript and wish to facilitate the communication between R and JavaScript.</p>

<h1 id="extendshinyjs-simple">Simple example</h1>

<p>Using <code class="highlighter-rouge">extendShinyjs</code> is very simple and makes defining and calling JavaScript functions painless. Here is a very basic example of using <code class="highlighter-rouge">extendShinyjs</code> to define a (fairly useless) function that changes the colour of the page.</p>

<blockquote>
  <p>Note: All the examples on this page assume that you have the <code class="highlighter-rouge">V8</code> package installed. If you cannot install <code class="highlighter-rouge">V8</code>, then you will need to use the <code class="highlighter-rouge">functions</code> argument of <code class="highlighter-rouge">extendShinyjs</code> (read more about this argument with <code class="highlighter-rouge">?shinyjs::extendShinyj</code>).</p>
</blockquote>

<div class="highlighter-rouge"><pre class="highlight"><code>library(shiny)
library(shinyjs)

jsCode &lt;- "shinyjs.pageCol = function(params){$('body').css('background', params);}"

shinyApp(
  ui = fluidPage(
    useShinyjs(),
    extendShinyjs(text = jsCode),
    selectInput("col", "Colour:",
                c("white", "yellow", "red", "blue", "purple"))
  ),
  server = function(input, output) {
    observeEvent(input$col, {
      js$pageCol(input$col)
    })
  }
)
</code></pre>
</div>

<p>Running the code above produces this shiny app:</p>

<p><img src="http://deanattali.com/img/blog/shinyjs-improvements/extendshinyjs-demo.gif" alt="Extendshinyjs demo" /></p>

<p>See how easy that was? All I had to do was make the JavaScript function <code class="highlighter-rouge">shinyjs.pageCol</code>, pass the JavaScript code as an argument to <code class="highlighter-rouge">extendShinyjs</code>, and then I can call <code class="highlighter-rouge">js$pageCol()</code>.  That’s the basic idea: any JavaScript function named <code class="highlighter-rouge">shinyjs.foo</code> will be available to call as <code class="highlighter-rouge">js$foo()</code>. You can either pass the JS code as a string to the <code class="highlighter-rouge">text</code> argument, or place the JS code in a separate JavaScript file and use the <code class="highlighter-rouge">script</code> argument to specify where the code can be found. Using a separate file is generally prefered over writing the code inline, but in these examples I will always use the <code class="highlighter-rouge">text</code> argument to keep it simple.</p>

<h1 id="extendshinyjs-onload">Running JavaScript code on page load</h1>

<p>If there is any JavaScript code that you want to run immediately when the page loads rather than having to call it from the server, you can place it inside a <code class="highlighter-rouge">shinyjs.init</code> function. The function <code class="highlighter-rouge">shinyjs.init</code> will automatically be called when the Shiny app’s HTML is initialized. A common use for this is when registering event handlers or initializing JavaScript objects, as these usually just need to run once when the page loads.</p>

<p>For example, the following example uses <code class="highlighter-rouge">shinyjs.init</code> to register an event
handler so that every keypress will print its corresponding key code:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>jscode &lt;- "
shinyjs.init = function() {
  $(document).keypress(function(e) { alert('Key pressed: ' + e.which); });
}"

shinyApp(
  ui = fluidPage(
    useShinyjs(),
    extendShinyjs(text = jscode),
    "Press any key"
  ),
  server = function(input, output) {}
)
</code></pre>
</div>

<h1 id="extendshinyjs-args">Passing arguments from R to JavaScript</h1>

<p>Any <code class="highlighter-rouge">shinyjs</code> function that is called will pass a single array-like parameter to its corresponding JavaScript function. If the function in R was called with unnamed arguments, then it will pass an Array of the arguments; if the R arguments are named then it will pass an Object with key-value pairs. For example, calling <code class="highlighter-rouge">js$foo("bar", 5)</code> in R will call <code class="highlighter-rouge">shinyjs.foo(["bar", 5])</code> in JS, while calling <code class="highlighter-rouge">js$foo(num = 5, id = "bar")</code> in R will call <code class="highlighter-rouge">shinyjs.foo({num : 5, id : "bar"})</code> in JS. This means that the <code class="highlighter-rouge">shinyjs.foo</code> function needs to be able to deal with both types of parameters.</p>

<p>To assist in normalizing the parameters, <code class="highlighter-rouge">shinyjs</code> provides a <code class="highlighter-rouge">shinyjs.getParams()</code> function which serves two purposes. First of all, it ensures that all arguments are named (even if the R function was called without names). Secondly, it allows you to define default values for arguments. Here is an example of a JS function that changes the background colour of an element and uses <code class="highlighter-rouge">shinyjs.getParams()</code>.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>shinyjs.backgroundCol = function(params) {
  var defaultParams = {
    id : null,
    col : "red"
  };
  params = shinyjs.getParams(params, defaultParams);

  var el = $("#" + params.id);
  el.css("background-color", params.col);
}
</code></pre>
</div>

<p>Note the <code class="highlighter-rouge">defaultParams</code> that we defined and the call to <code class="highlighter-rouge">shinyjs.getParams</code>. It ensures that calling <code class="highlighter-rouge">js$backgroundCol("test", "blue")</code> and <code class="highlighter-rouge">js$backgroundCol(id = "test", col = "blue")</code> and <code class="highlighter-rouge">js$backgroundCol(col = "blue", id = "test")</code> are all equivalent, and that if the colour parameter is not provided then “red” will be the default.  All the functions provided in <code class="highlighter-rouge">shinyjs</code> make use of <code class="highlighter-rouge">shinyjs.getParams</code>, and it is highly recommended to always use it in your functions as well. Notice that the order of the arguments in <code class="highlighter-rouge">defaultParams</code> in the JavaScript function matches the order of the arguments when calling the function in R with unnamed arguments. This means that <code class="highlighter-rouge">js$backgroundCol("blue", "test")</code> will not work because the arguments are unnamed and the JS function expects the id to come before the colour.</p>

<p>For completeness, here is the code for a shiny app that uses the above function (it’s not a very practical example, but it’s great for showing how to use <code class="highlighter-rouge">extendShinyjs</code> with parameters):</p>

<div class="highlighter-rouge"><pre class="highlight"><code>library(shiny)
library(shinyjs)

jsCode &lt;- '
shinyjs.backgroundCol = function(params) {
  var defaultParams = {
    id : null,
    col : "red"
  };
  params = shinyjs.getParams(params, defaultParams);

  var el = $("#" + params.id);
  el.css("background-color", params.col);
}'

shinyApp(
  ui = fluidPage(
    useShinyjs(),
    extendShinyjs(text = jsCode),
    p(id = "name", "My name is Dean"),
    p(id = "sport", "I like soccer"),
    selectInput("col", "Colour:",
                c("white", "yellow", "red", "blue", "purple")),    
    textInput("selector", "Element", ""),
    actionButton("btn", "Go")
  ),
  server = function(input, output) {
    observeEvent(input$btn, {
      js$backgroundCol(input$selector, input$col)
    })
  }
)
</code></pre>
</div>

<p>And the resulting app:</p>

<p><img src="http://deanattali.com/img/blog/shinyjs-improvements/extendshinyjs-params.gif" alt="Extendshinyjs params demo" /></p>

<p>Note that I chose to define the JS code as a string for illustration purposes, but in reality I would prefer to place the code in a separate file and use the <code class="highlighter-rouge">script</code> argument instead of <code class="highlighter-rouge">text</code>.</p>

    </div>
  </div>
</div>


    <footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-12 col-md-12 col-sm-12">
        <div id="footer-awesome">Ready to make your Shiny apps awesome?</div>
        <code>install.packages("shinyjs")</code>
        <p class="copyright">
		      <strong>shinyjs</strong>
          by
          <a href="http://deanattali.com">Dean Attali</a>
		      &nbsp;&bull;&nbsp;
          <a href="https://github.com/daattali/shinyjs">View on GitHub</a>
	      </p>
		    <p class="theme-by">
		      Theme by
	  	    <a href="http://deanattali.com/beautiful-jekyll/">beautiful-jekyll</a>
	  	  </p>
        <a href="https://www.paypal.me/daattali">
          <img src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_LG.gif">
        </a>
      </div>
    </div>
  </div>
</footer>

  
    






  
    <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
    
      <script>
      	if (typeof jQuery == 'undefined') {
      	  document.write('<script src="/shinyjs/js/jquery-1.11.2.min.js"></scr' + 'ipt>');
      	}
      </script>
    
  
    <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
    
	<script src="/shinyjs/js/bootstrap.min.js"></script>
    
  
    <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
    
	<script src="/shinyjs/js/main.js"></script>
    
  



	<!-- Google Analytics -->
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
		ga('create', 'UA-59820529-1', 'auto');
		ga('send', 'pageview');
	</script>
	<!-- End Google Analytics -->


  
  </body>
</html>
